
DROP VIEW public.amphibia_view ;
CREATE OR REPLACE VIEW public.amphibia_view AS
 SELECT "TAXREFv10"."CD_NOM" as taxref_id,
    "TAXREFv10"."NOM_VALIDE" as latin,
    "TAXREFv10"."NOM_VERN" as vernaculaire
   FROM "TAXREFv10"
  WHERE "TAXREFv10"."GROUP2_INPN"::text = 'Amphibiens'::text 
  AND "TAXREFv10"."FR"::text = 'P'::text 
  AND "TAXREFv10"."CD_NOM"::integer = "TAXREFv10"."CD_REF"::integer
  AND ("TAXREFv10"."RANG"::text = ANY (ARRAY['ES'::character varying, 'GN'::character varying]::text[]));

ALTER TABLE public.amphibia_view
    OWNER TO postgres;


DROP VIEW public.bird_view;
CREATE OR REPLACE VIEW public.bird_view AS
 SELECT "TAXREFv10"."CD_NOM" as taxref_id,
    "TAXREFv10"."NOM_VALIDE" as latin,
    "TAXREFv10"."NOM_VERN" as vernaculaire
   FROM "TAXREFv10"
  WHERE "TAXREFv10"."GROUP2_INPN"::text = 'Oiseaux'::text 
  AND "TAXREFv10"."FR"::text = 'P'::text 
  AND "TAXREFv10"."CD_NOM"::integer = "TAXREFv10"."CD_REF"::integer
  AND ("TAXREFv10"."RANG"::text = ANY (ARRAY['ES'::character varying, 'GN'::character varying]::text[]));


ALTER TABLE public.bird_view
    OWNER TO postgres;
    

-- View: public.chiroptera_view

DROP VIEW public.chiroptera_view;
CREATE OR REPLACE VIEW public.chiroptera_view AS
 SELECT "TAXREFv10"."CD_NOM" as taxref_id,
    "TAXREFv10"."NOM_VALIDE" as latin,
    "TAXREFv10"."NOM_VERN" as vernaculaire
   FROM "TAXREFv10"
  WHERE "TAXREFv10"."GROUP2_INPN"::text = 'Mammifères'::text 
  AND "TAXREFv10"."ORDRE"::text = 'Chiroptera'::text 
  AND "TAXREFv10"."FR"::text = 'P'::text 
  AND "TAXREFv10"."CD_NOM"::integer = "TAXREFv10"."CD_REF"::integer
  AND ("TAXREFv10"."RANG"::text = ANY (ARRAY['ES'::character varying, 'GN'::character varying]::text[]));


ALTER TABLE public.chiroptera_view
    OWNER TO postgres;


-- View: public.insect_view

DROP VIEW public.insect_view;
CREATE OR REPLACE VIEW public.insect_view AS
 SELECT "TAXREFv10"."CD_NOM" as taxref_id,
    "TAXREFv10"."NOM_VALIDE" as latin,
    "TAXREFv10"."NOM_VERN" as vernaculaire
   FROM "TAXREFv10"
  WHERE "TAXREFv10"."GROUP2_INPN"::text = 'Insectes'::text 
  AND "TAXREFv10"."FR"::text = 'P'::text 
  AND "TAXREFv10"."CD_NOM"::integer = "TAXREFv10"."CD_REF"::integer
  AND ("TAXREFv10"."RANG"::text = ANY (ARRAY['ES'::character varying, 'GN'::character varying]::text[]));


ALTER TABLE public.insect_view
    OWNER TO postgres;


-- View: public.mammal_view

DROP VIEW public.mammal_view;
CREATE OR REPLACE VIEW public.mammal_view AS
 SELECT "TAXREFv10"."CD_NOM" as taxref_id,
    "TAXREFv10"."NOM_VALIDE" as latin,
    "TAXREFv10"."NOM_VERN" as vernaculaire
   FROM "TAXREFv10"
  WHERE "TAXREFv10"."GROUP2_INPN"::text = 'Mammifères'::text 
  AND "TAXREFv10"."ORDRE"::text <> 'Cetartiodactyla'::text 
  AND ("TAXREFv10"."FAMILLE"::text <> ALL (ARRAY['Balaenopteridae'::character varying, 'Delphinidae'::character varying, 'Ziphiidae'::character varying, 'Balaenidae'::character varying]::text[])) 
  AND "TAXREFv10"."FR"::text = 'P'::text 
  AND "TAXREFv10"."CD_NOM"::integer = "TAXREFv10"."CD_REF"::integer
  AND ("TAXREFv10"."RANG"::text = ANY (ARRAY['ES'::character varying, 'GN'::character varying]::text[]));


ALTER TABLE public.mammal_view
    OWNER TO postgres;



DROP VIEW public.reptil_view;

CREATE OR REPLACE VIEW public.reptil_view AS
 SELECT "TAXREFv10"."CD_NOM" as taxref_id,
    "TAXREFv10"."NOM_VALIDE" as latin,
    "TAXREFv10"."NOM_VERN" as vernaculaire
   FROM "TAXREFv10"
  WHERE "TAXREFv10"."GROUP2_INPN"::text = 'Reptiles'::text 
  AND "TAXREFv10"."FR"::text = 'P'::text 
  AND "TAXREFv10"."CD_NOM"::integer = "TAXREFv10"."CD_REF"::integer
  AND ("TAXREFv10"."RANG"::text = ANY (ARRAY['ES'::character varying, 'GN'::character varying]::text[]));


ALTER TABLE public.reptil_view
    OWNER TO postgres;



--DROP VIEW public.phyto_view;

CREATE OR REPLACE VIEW public.phyto_view AS
 SELECT "TAXREFv10"."CD_NOM" as taxref_id,
    "TAXREFv10"."NOM_VALIDE" as latin,
    "TAXREFv10"."NOM_VERN" as vernaculaire
   FROM "TAXREFv10"
  WHERE "TAXREFv10"."GROUP2_INPN"::text IN ('Gymnospermes'::text, 'Angiospermes'::text)
  AND "TAXREFv10"."FR"::text = 'P'::text 
  AND "TAXREFv10"."CD_NOM"::integer = "TAXREFv10"."CD_REF"::integer
  AND ("TAXREFv10"."RANG"::text = ANY (ARRAY['ES'::character varying, 'GN'::character varying]::text[]));


ALTER TABLE public.phyto_view
    OWNER TO postgres;








INSERT INTO [dbo].[TVersion] (TVer_FileName,TVer_Date,TVer_DbName) VALUES ('2_Update_TaxRef_View',GETDATE(),(SELECT db_name()))


GO
